<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE dmodule [
<!ENTITY % ISOEntities PUBLIC "ISO 8879-1986//ENTITIES ISO Character Entities 20030531//EN//XML" "http://www.s1000d.org/S1000D_4-2/ent/ISOEntities">
]>
<dmodule xmlns:dc="http://www.purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://www.s1000d.org/S1000D_4-2/xml_schema_flat/descript.xsd">
  <identAndStatusSection>
    <dmAddress>
      <dmIdent>
        <dmCode modelIdentCode="S1000DTOOLS" systemDiffCode="A" systemCode="00" subSystemCode="0" subSubSystemCode="4" assyCode="00" disassyCode="00" disassyCodeVariant="A" infoCode="040" infoCodeVariant="A" itemLocationCode="D"/>
        <language languageIsoCode="en" countryIsoCode="CA"/>
        <issueInfo issueNumber="006" inWork="00"/>
      </dmIdent>
      <dmAddressItems>
        <issueDate year="2017" month="10" day="10"/>
        <dmTitle>
          <techName>s1kd-brexcheck</techName>
          <infoName>Description</infoName>
        </dmTitle>
      </dmAddressItems>
    </dmAddress>
    <dmStatus issueType="changed">
      <security securityClassification="01"/>
      <responsiblePartnerCompany>
        <enterpriseName>khzae.net</enterpriseName>
      </responsiblePartnerCompany>
      <originator>
        <enterpriseName>khzae.net</enterpriseName>
      </originator>
      <applic>
        <displayText>
          <simplePara>All</simplePara>
        </displayText>
      </applic>
      <brexDmRef>
        <dmRef>
          <dmRefIdent>
            <dmCode modelIdentCode="S1000D" systemDiffCode="F" systemCode="04" subSystemCode="1" subSubSystemCode="0" assyCode="0301" disassyCode="00" disassyCodeVariant="A" infoCode="022" infoCodeVariant="A" itemLocationCode="D"/>
          </dmRefIdent>
        </dmRef>
      </brexDmRef>
      <qualityAssurance>
        <unverified/>
      </qualityAssurance>
    </dmStatus>
  </identAndStatusSection>
  <content>
    <description>
      <levelledPara>
        <title>General</title>
        <para>The <emphasis>s1kd-brexcheck</emphasis> tool validates an S1000D data module using the context rules of one or multiple <acronym acronymType="at01"><acronymTerm>BREX</acronymTerm><acronymDefinition>Business Rules EXchange</acronymDefinition></acronym> data modules. All errors are displayed with the &lt;objectUse&gt; message, the line number, and a representation of the invalid XML tree.</para>
      </levelledPara>
      <levelledPara>
        <title>Usage</title>
        <para>s1kd-brexcheck [-b &lt;brex&gt;] [-I &lt;path&gt;] [-w &lt;severities&gt;] [-vVqDsxlSh?] &lt;datamodules&gt;</para>
      </levelledPara>
      <levelledPara>
        <title>Options</title>
        <para>
          <definitionList>
            <definitionListItem>
              <listItemTerm>-b &lt;brex&gt;</listItemTerm>
              <listItemDefinition>
                <para>Check the data modules against this BREX. Multiple BREX data modules can be specified by adding this option multiple times. When no BREX data modules are specified, the BREX data module referenced in &lt;brexDmRef&gt; in the data module is attempted to be used instead.</para>
              </listItemDefinition>
            </definitionListItem>
            <definitionListItem>
              <listItemTerm>-I &lt;path&gt;</listItemTerm>
              <listItemDefinition>
                <para>Add a search path for BREX data modules. By default, only the current directory is searched.</para>
              </listItemDefinition>
            </definitionListItem>
            <definitionListItem>
              <listItemTerm>-v -V -q -D</listItemTerm>
              <listItemDefinition>
                <para>Verbosity of the output.</para>
              </listItemDefinition>
            </definitionListItem>
            <definitionListItem>
              <listItemTerm>-s</listItemTerm>
              <listItemDefinition>
                <para>Use shortened, single-line messages to report BREX errors instead of multiline indented messages.</para>
              </listItemDefinition>
            </definitionListItem>
            <definitionListItem>
              <listItemTerm>-x</listItemTerm>
              <listItemDefinition>
                <para>Output an XML report instead of a plain-text one.</para>
              </listItemDefinition>
            </definitionListItem>
            <definitionListItem>
              <listItemTerm>-l</listItemTerm>
              <listItemDefinition>
                <para>Use the layered BREX concept. BREX data modules referenced by other BREX data modules (either specified with -b or referenced by the specified data modules) will also be checked against.</para>
              </listItemDefinition>
            </definitionListItem>
            <definitionListItem>
              <listItemTerm>-w &lt;severities&gt;</listItemTerm>
              <listItemDefinition>
                <para>Specify a list of severity levels for business rules.</para>
              </listItemDefinition>
            </definitionListItem>
            <definitionListItem>
              <listItemTerm>-S</listItemTerm>
              <listItemDefinition>
                <para>Check SNS rules. The SNS of each specified data module is checked against the combination of all SNS rules of all specified BREX data modules.</para>
              </listItemDefinition>
            </definitionListItem>
            <definitionListItem>
              <listItemTerm>-t</listItemTerm>
              <listItemDefinition>
                <para>Strict SNS checking. By default, the SNS check (-S) will assume optional elements snsSubSystem, snsSubSubSystem, and snsAssy exist with an snsCode of "0" ("00" or "0000" for snsAssy) when their parent element does not contain any of each. This provides a shorthand, such that</para>
                <para>
                  <verbatimText verbatimStyle="vs11">&lt;snsSystem&gt;
  &lt;snsCode&gt;00&lt;/snsCode&gt;
  &lt;snsTitle&gt;General&lt;/snsTitle&gt;
&lt;/snsSystem&gt;</verbatimText>
                </para>
                <para>is equivalent to</para>
                <para>
                  <verbatimText verbatimStyle="vs11">&lt;snsSystem&gt;
  &lt;snsCode&gt;00&lt;/snsCode&gt;
  &lt;snsTitle&gt;General&lt;/snsTitle&gt;
  &lt;snsSubSystem&gt;
    &lt;snsCode&gt;0&lt;/snsCode&gt;
    &lt;snsTitle&gt;General&lt;/snsTitle&gt;
    &lt;snsSubSubSystem&gt;
      &lt;snsCode&gt;0&lt;/snsCode&gt;
      &lt;snsTitle&gt;General&lt;/snsTitle&gt;
      &lt;snsAssy&gt;
        &lt;snsCode&gt;00&lt;/snsCode&gt;
        &lt;snsTitle&gt;General&lt;/snsTitle&gt;
      &lt;/snsAssy&gt;
    &lt;/snsSubSubSystem&gt;
  &lt;/snsSubSystem&gt;
&lt;/snsSystem&gt;</verbatimText>
                </para>
                <para>Specifying the -t option will disable this shorthand, and missing optional elements will result in an error.</para>
              </listItemDefinition>
            </definitionListItem>
            <definitionListItem>
              <listItemTerm>-h -?</listItemTerm>
              <listItemDefinition>
                <para>Show the help/usage message.</para>
              </listItemDefinition>
            </definitionListItem>
          </definitionList>
        </para>
        <levelledPara>
          <title>Business rule severity levels (-w)</title>
          <para>The attribute brSeverityLevel on a BREX rule allows for distinguishing different kinds of errors. The -w option takes an XML file containing a list of severity levels, their user-defined type, and optionally if they should not be counted as true errors (causing the tool to return a "failure" status) but merely warnings.</para>
          <para>An example of the format of this file is given below:</para>
          <para>
            <verbatimText verbatimStyle="vs11">&lt;?xml version="1.0"?&gt;
&lt;brSeverityLevels&gt;
  &lt;brSeverityLevel value="brsl01" fail="yes"&gt;Error&lt;/brSeverityLevel&gt;
  &lt;brSeverityLevel value="brsl02" fail="no"&gt;Warning&lt;/brSeverityLevel&gt;
&lt;/brSeverityLevels&gt;</verbatimText>
          </para>
          <para>When the attribute <verbatimText verbatimStyle="vs13">fail</verbatimText> has a value of "yes" (or is not included), BREX errors pertaining to rules with the given severity level value will be counted as errors. When it is no, the errors are still displayed but are not counted as errors in the exit status code of the tool.</para>
        </levelledPara>
      </levelledPara>
      <levelledPara>
        <title>Example</title>
        <para>
          <verbatimText verbatimStyle="vs23">$ DMOD=DMC-S1000DTOOLS-A-00-00-00-00A-040A-D_000-01_EN-CA.XML
$ BREX=DMC-S1000D-F-04-10-0301-00A-022A-D_001-00_EN-US.XML
$ cat $DMOD
[...]
&lt;listItem id="stp-0001"&gt;
  &lt;para&gt;List items shouldn't be used as steps...&lt;/para&gt;
&lt;/listItem&gt;
[...]
&lt;para&gt;Refer to &lt;internalRef internalRefId="stp-0001" internalRefTargetType="irtt08"/&gt;.&lt;/para&gt;
[...]

$ s1kd-brexcheck -b $BREX $DMOD
BREX ERROR: DMC-S1000DTOOLS-A-00-00-00-00A-040A-D_000-01_EN-CA.XML
  Only when the reference target is a step can the value of attribute
internalRefTargetType be irtt08 (Chap 3.9.5.2.1.2, Para 2.1).
  line 53:
    ELEMENT internalRef
      ATTRIBUTE internalRefId
        TEXT
          content=stp-0001
      ATTRIBUTE internalRefTargetType
        TEXT
          content=irtt08</verbatimText>
        </para>
      </levelledPara>
    </description>
  </content>
</dmodule>
